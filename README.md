# SHA-256 quasi-collision

My answer to [this Cryptography Stack Exchange question](https://crypto.stackexchange.com/q/119199/48650) from December 2025.

## CPU

Once you have [Rust](https://rust-lang.org/) and [Python](https://www.python.org/) installed (or you can just use the [Nix](https://nixos.org/) dev shell), run this command:

```sh
cargo run --release | tee check.py
```

Let it run however long you like, then stop it with `^C`. To validate the results, run this other command:

```sh
python3 check.py
```

For example, here is a `check.py` generated by my machine with an AMD Ryzen 9 9950X CPU:

```python
from hashlib import sha256
def check(c, s, t):
    a = sha256(bytes.fromhex(s)).digest()
    b = sha256(bytes.fromhex(t)).digest()
    assert c == sum((x ^ y ^ 0xff).bit_count() for (x, y) in zip(a, b))
check(125, "00000000", "00000001")  # found after 726.991µs
check(135, "00000002", "00000003")  # found after 733.223µs
check(137, "00000002", "00000005")  # found after 736.86µs
check(138, "00000000", "00000007")  # found after 737.892µs
check(149, "00000004", "00000008")  # found after 738.513µs
check(151, "00000005", "0000000c")  # found after 739.585µs
check(158, "0000001a", "00000022")  # found after 743.693µs
check(161, "00000027", "000000bc")  # found after 828.613µs
check(163, "000000be", "00000240")  # found after 1.431009ms
check(164, "00000245", "0000024b")  # found after 1.457579ms
check(166, "0000007a", "00000299")  # found after 1.704865ms
check(167, "000000ef", "00000630")  # found after 5.811881ms
check(169, "000002f9", "000009d8")  # found after 17.49308ms
check(174, "00001e40", "00001faf")  # found after 159.083325ms
check(175, "000019af", "000053e2")  # found after 543.933933ms
check(176, "00005355", "0000b38e")  # found after 1.291938446s
check(177, "0000c367", "000116e2")  # found after 2.199669859s
check(178, "00019300", "0001b012")  # found after 4.079794687s
check(179, "0001b86e", "00033e15")  # found after 11.431695326s
check(180, "000445a9", "00050022")  # found after 22.621640663s
check(181, "00045991", "0005137f")  # found after 23.258178258s
check(183, "0004733a", "000611c7")  # found after 31.055611575s
check(184, "001101ac", "001bce77")  # found after 479.011581654s
check(185, "002cb3ba", "003e9c7f")  # found after 3706.773646322s
check(186, "003b668c", "004347a2")  # found after 4386.02443906s
```

## GPU

Once you have CUDA installed (or, again, just use the Nix dev shell), run this command:

```sh
make && ./quasi_cuda | tee check.py
```

Just like the CPU version, can validate the results like this:

```sh
python3 check.py
```

For example, here is a `check.py` generated by my machine with an NVIDIA RTX 3070 GPU:

```python
from hashlib import sha256
def check(c, s, t):
    a = sha256(bytes.fromhex(s)).digest()
    b = sha256(bytes.fromhex(t)).digest()
    assert c == sum((x ^ y ^ 0xff).bit_count() for (x, y) in zip(a, b))
check(176, "00005355", "0000b38e")  # found after 0.031610s
check(177, "0000c367", "000116e2")  # found after 0.064401s
check(179, "0000b25f", "0005cfbf")  # found after 0.190684s
check(180, "0000c7df", "0013ec2c")  # found after 0.610691s
check(181, "0000a5eb", "0020888f")  # found after 0.996493s
check(184, "00004ecb", "0023844b")  # found after 1.086008s
check(185, "0000febb", "01e259db")  # found after 14.619877s
check(186, "00002f8e", "091d261c")  # found after 71.001859s
check(187, "0000ef0d", "2a7580bf")  # found after 324.560750s
check(190, "0000b13b", "3ccd1b9d")  # found after 464.343813s
check(191, "00012444", "9153356f")  # found after 3064.334036s
```
