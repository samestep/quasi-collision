# SHA-256 quasi-collision

My answer to [this Cryptography Stack Exchange question](https://crypto.stackexchange.com/q/119199/48650) from December 2025.

## CPU

Once you have [Rust](https://rust-lang.org/) and [Python](https://www.python.org/) installed (or you can just use the [Nix](https://nixos.org/) dev shell), run this command:

```sh
cargo run --release | tee check.py
```

Let it run however long you like, then stop it with `^C`. To validate the results, run this other command:

```sh
python3 check.py
```

For example, here is a `check.py` generated by my machine with an AMD Ryzen 9 9950X CPU:

```python
from hashlib import sha256
def check(c, s, t):
    a = sha256(bytes.fromhex(s)).digest()
    b = sha256(bytes.fromhex(t)).digest()
    assert c == sum((x ^ y ^ 0xff).bit_count() for (x, y) in zip(a, b))
check(121, "00000000", "00000300")  # found after 150.66µs
check(122, "00000001", "00000300")  # found after 161.74µs
check(138, "00000003", "00000300")  # found after 163.103µs
check(145, "00000004", "00000300")  # found after 163.744µs
check(148, "0000000f", "00000300")  # found after 164.515µs
check(150, "000000fe", "00000300")  # found after 168.593µs
check(152, "00000220", "00000300")  # found after 180.755µs
check(156, "000000e9", "00000301")  # found after 186.566µs
check(157, "000003bb", "00000600")  # found after 191.075µs
check(161, "00000120", "00000308")  # found after 201.694µs
check(162, "000005e3", "00000622")  # found after 273.488µs
check(165, "000014ce", "00001509")  # found after 284.849µs
check(166, "00001813", "00001b2a")  # found after 453.161µs
check(167, "00000742", "000009f1")  # found after 2.905064ms
check(169, "0000257b", "000027b1")  # found after 2.909783ms
check(172, "00002f4b", "0000391e")  # found after 11.992639ms
check(174, "00005752", "00007956")  # found after 35.81772ms
check(175, "000019af", "000053e2")  # found after 62.943078ms
check(176, "00005355", "0000b38e")  # found after 103.847824ms
check(177, "000003b9", "00025d26")  # found after 692.674698ms
check(178, "00004f34", "000781f3")  # found after 2.042179562s
check(184, "00004ecb", "0023844b")  # found after 10.040578189s
check(185, "0000263a", "06c4372e")  # found after 475.72713249s
check(186, "00002f8e", "091d261c")  # found after 665.747762513s
```

## GPU

Once you have CUDA installed (or, again, just use the Nix dev shell), run this command:

```sh
make && ./quasi_cuda | tee check.py
```

Just like the CPU version, can validate the results like this:

```sh
python3 check.py
```

For example, here is a `check.py` generated by my machine with an NVIDIA RTX 3070 GPU:

```python
from hashlib import sha256
def check(c, s, t):
    a = sha256(bytes.fromhex(s)).digest()
    b = sha256(bytes.fromhex(t)).digest()
    assert c == sum((x ^ y ^ 0xff).bit_count() for (x, y) in zip(a, b))
check(176, "00005355", "0000b38e")  # found after 0.031610s
check(177, "0000c367", "000116e2")  # found after 0.064401s
check(179, "0000b25f", "0005cfbf")  # found after 0.190684s
check(180, "0000c7df", "0013ec2c")  # found after 0.610691s
check(181, "0000a5eb", "0020888f")  # found after 0.996493s
check(184, "00004ecb", "0023844b")  # found after 1.086008s
check(185, "0000febb", "01e259db")  # found after 14.619877s
check(186, "00002f8e", "091d261c")  # found after 71.001859s
check(187, "0000ef0d", "2a7580bf")  # found after 324.560750s
check(190, "0000b13b", "3ccd1b9d")  # found after 464.343813s
check(191, "00012444", "9153356f")  # found after 3064.334036s
```
